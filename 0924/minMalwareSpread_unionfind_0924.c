#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <limits.h>
#include <stdbool.h>

#define NODE_MAX 302
#define MAX(a, b) (a) > (b) ? (a) : (b)
#define MIN(a, b) (a) < (b) ? (a) : (b)
int g_delnum[NODE_MAX];
int g_pre[NODE_MAX];
int g_hashtype[NODE_MAX];

int Find(int i)
{
    if (i != g_pre[i]) {
        g_pre[i] = Find(g_pre[i]);
    }
    return g_pre[i];
}

void Join(int i, int j)
{
    int pi = Find(i);
    int pj = Find(j);
    if (pi == pj) {
        return;
    } else if (pi < pj) {
        g_pre[pj] = pi;
    } else {
        g_pre[pi] = pj;
    }
    // for (int i = 0; i <= 24; i++) printf("%d ", g_pre[i]);
    // printf("\n");
}

void HanldeAllParnet(int len)
{
    for (int i = 0; i < len; i++) {
        Find(i);
    }
    // for (int i = 0; i <= 24; i++) printf("%d ", g_pre[i]);
    // printf("\n");
}

void InitParent(int** graph, int graphSize)
{
    for (int i = 0; i < graphSize; i++) {
        g_pre[i] = i;
        g_hashtype[i] = 0;
        g_delnum[i] = 0;
    }
    for (int i = 0; i < graphSize; i++) {
        for (int j = 0; j < graphSize; j++) {
            if (graph[i][j] == 1) {
                Join(i, j);
            }
        }
    }
    for (int i = 0; i < graphSize; i++) {
        int t = Find(i);
        g_hashtype[t]++;
    }
}

int minMalwareSpread(int** graph, int graphSize, int* graphColSize, int* initial, int initialSize)
{
    int maxNum = 0;
    int id = INT_MAX;
    InitParent(graph, graphSize);
    for (int i = 0; i < initialSize; i++) {
        int t = Find(initial[i]);
        g_delnum[t]++;
    }
    for (int i = 0; i < initialSize; i++) {
        int delV = initial[i];
        int devLP = Find(delV);
        if (g_delnum[devLP] == 1) {
            if (g_hashtype[devLP] == maxNum) {
                id = MIN(id, delV);
            } else if (g_hashtype[devLP] > maxNum) {
                id = delV;
                maxNum = g_hashtype[devLP];
            }
        }
    }
    if (id == INT_MAX) {
        for (int i = 0; i < initialSize; i++) {
            id = MIN(id, initial[i]);
        }
    }
    return id;
}